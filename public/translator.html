<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Traduire une image ou un fichier</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="container">
    <h2>Traduire une image / fichier</h2>

    <input type="file" id="imageUpload" accept="image/*">
    <button onclick="analyzeImage()">Analyser l’image</button>

    <div id="detectedText" class="output"></div>

    <h3>Traduction :</h3>
    <div id="translatedText" class="output"></div>

    <a class="btn-link" href="index.html">← Retour</a>
  </div>

  <script>
    async function analyzeImage() {
      const fileInput = document.getElementById('imageUpload');
      const detectedDiv = document.getElementById('detectedText');
      const translatedDiv = document.getElementById('translatedText');

      if (!fileInput.files[0]) {
        alert("Ajoute une image !");
        return;
      }

      detectedDiv.textContent = "Analyse de l’image...";
      translatedDiv.textContent = "";

      const reader = new FileReader();
      reader.onload = async () => {
        try {
          const res = await Tesseract.recognize(reader.result, 'eng');
          const text = res.data.text;
          detectedDiv.textContent = text;

          const translated = await translateText(text, "fr");
          translatedDiv.textContent = translated;

        } catch (e) {
          detectedDiv.textContent = "Erreur : " + e.message;
        }
      };
      reader.readAsDataURL(fileInput.files[0]);
    }

    async function translateText(input, targetLang = "fr") {
      const res = await fetch(`https://api.mymemory.translated.net/get?q=${encodeURIComponent(input)}&langpair=en|${targetLang}`);
      const data = await res.json();
      return data.responseData.translatedText;
    }
  </script>
  <script src="https://cdn.jsdelivr.net/npm/tesseract.js@2/dist/tesseract.min.js"></script>
</body>
</html>
